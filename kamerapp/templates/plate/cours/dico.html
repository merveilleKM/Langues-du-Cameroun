{% extends "plate/cours/base.html" %}

{% block main %}

<div class="col-md-9 mt-3">
    <div class="container">
        <h2 class="text-center">Traducteur</h2>
        <div class="mot">
            <!-- Formulaire de recherche -->
            <div class="row my-4">
                <div class="col bg-light p-3">
                    <form class="d-flex" role="search" method="get" action="">
                        <input class="form-control me-2 p-3" name="mot" id="inputField" type="search" placeholder="Entrez le mot à traduire" aria-label="Search" required>
    
                        <label for="sens" class="me-2">Sens :</label>
                        <select name="sens" id="sens" class="form-control me-2" required>
                            <option value="fr-to-trad">Français vers {{ cours.langue.nomlangue }}</option>
                            <option value="trad-to-fr">{{ cours.langue.nomlangue }} vers Français</option>
                        </select>
    
                        <button class="btn btn-outline-success p-3" type="submit">Traduire</button>
                    </form>
                </div>
            </div>
    
            <!-- Résultat de la recherche -->
            <div class="row my-4">
                <div class="col bg-light p-3 h-auto">
                    <p><strong>Résultat</strong></p>
                    {% if result %}
    <ul>
        {% if sens == 'fr-to-trad' %}
            <li>{{ result.mot_francais }} se traduit en <strong>{{ result.mot_traditionnel }}</strong></li>
        {% elif sens == 'trad-to-fr' %}
            <li>{{ result.mot_traditionnel }} se traduit en <strong>{{ result.mot_francais }}</strong></li>
        {% endif %}
    </ul>

    <!-- Affichage de l'image -->
    {% if result.image %}
        <img src="{{ result.image.url }}" alt="Illustration de {{ result.mot_francais }}" width="70" class="mx-5">
    {% endif %}

    <!-- Lecture de l'audio -->
    {% if result.audio %}
        <audio controls>
            <source src="{{ result.audio.url }}" type="audio/mpeg">
            Votre navigateur ne supporte pas l'élément audio.
        </audio>
    {% endif %}
{% else %}
    <p>Aucune traduction trouvée pour "{{ mot }}" dans la langue "{{ cours.langue.nomlangue }}".</p>
{% endif %}

                </div>
            </div>
        </div>
    </div>

    <!-- Clavier Virtuel -->
    <div id="keyboard" class="my-3">
        <div class="simple-keyboard"></div>
    </div>
</div>

<!-- Inclure les styles CSS pour le clavier -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simple-keyboard@latest/build/css/index.css">

<!-- Inclure le script JavaScript pour simple-keyboard -->
<script src="https://cdn.jsdelivr.net/npm/simple-keyboard@latest/build/index.js"></script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const Keyboard = window.SimpleKeyboard.default;

        const keyboard = new Keyboard({
            onChange: input => onInput(input),
            layout: {
                default: [
                    'a à â ǎ á a̍ ā À æ Æ ɑ Ɑ b B ɓ Ɓ c ç ɔ̀ ɔ́ ɔ̌ ɔ Ɔ',
                    'd D ɗ Ɗ ɛ Ɛ ɛ̀ ɛ́ ɛ̂ ě ê é è f F g G ɡ ʼ h H',
                    'ǐ ɨ Ɨ í ì î ï ī j J k K l L ʉ Ʉ u ú ù ʉ̀ U',
                    'e E ø Ø ɤ ʌ o O ó ò ô õ ö ø œ Œ ə Ə p P t T ƴ Ƴ',
                    'm M ḿ n N Ŋ ŋ Ŋ̀ ŋ̂ ñ v V s S z Z ʒ x X t͡ʃ ʄ d͡ʒ ʙ',
                    'r R ẅ Ẅ β y Y w W ʃ zh ɣ y ɬ ɮ',
                ]
            }
        });

        function onInput(input) {
            document.getElementById("inputField").value = input;
        }

        document.getElementById("inputField").addEventListener("input", (event) => {
            keyboard.setInput(event.target.value);
        });
    });
</script>

{% endblock %}