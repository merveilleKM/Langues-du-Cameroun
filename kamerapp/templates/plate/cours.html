{% extends "plate/base.html" %}

{% load static %}

{% block dash %}

<!-- Search Bar -->
<div class="search-container">
    <form method="GET" action="{% url 'searchcours' %}" class="d-flex align-items-center">
        <input type="text" name="q" class="form-control me-2" placeholder="Rechercher un sujet ou un post..." 
            value="{{ query|default:'' }}"
        >
        <button type="submit" class="btn btn-main p-2">
            <i class="fas fa-search"></i>
        </button>
    </form>
</div>

<!-- Courses List -->
<section class="course-list">
    <div class="container">
        <h2 class="text-center mb-4">Mes Cours 
            <span>
                <img src="{% static 'img/note.gif' %}" alt="Apprentissage" style="max-width: 50px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);">
            </span> 
        </h2>
        
        <!-- Message si aucun cours n'est trouvÃ© -->
        {% if not cours %}
            <p class="text-center">Aucun cours trouvÃ© pour "{{ query }}".</p>
        {% endif %}

        <!-- Liste des cours -->
        <div class="course-item-container">
            {% for cour in cours %}
            <div class="course-item">
                <a href="{% url 'detail' cour.slug %}" class="course-link">
                    <img src="{% if cour.image %}{{ cour.image.url }}{% else %}{% static 'img/default-course-image.png' %}{% endif %}" 
                         alt="{{ cour.nomlangue }}" class="course-image">
                </a>
                <div class="course-details">
                    <a href="{% url 'detail' cour.slug %}" class="course-title-link">
                        <h5>ðŸ“˜ {{ cour.nomlangue }}</h5>
                    </a>
                    <p>{{ cour.description|default:"Aucune description disponible." }}</p>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" data-progress="70" aria-valuemin="0" aria-valuemax="100">
                            <span>70%</span>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<script>
    // Animation des progress bars
    document.addEventListener("DOMContentLoaded", function () {
        const progressBars = document.querySelectorAll(".progress-bar");
        progressBars.forEach(bar => {
            const progress = bar.getAttribute("data-progress");
            bar.style.width = "0"; // Initial width
            setTimeout(() => {
                bar.style.width = progress + "%";
                bar.querySelector("span").innerText = progress + "%"; // Met Ã  jour le texte
            }, 100); // Delay for smoother animation
        });
    });
</script>

<style>
    .progress-bar {
        transition: width 1.5s ease-in-out;
        display: flex;
        justify-content: center;
        align-items: center;
        color: #fff;
        font-weight: bold;
    }
    .progress-bar span {
        position: absolute;
    }

    .course-item a {
        display: block;
        text-decoration: none;
        color: inherit;
    }
    .course-item a:hover {
        color: #ff8c00;
        font-weight: bold;
    }
</style>

{% endblock %}